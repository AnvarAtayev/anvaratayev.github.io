<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns:m="http://www.w3.org/1998/Math/MathML" xmlns="http://www.w3.org/1999/xhtml" xmlns:x="https://www.texmacs.org/2002/extensions">
  <head>
    <title>No title</title>
    <meta content="TeXmacs 1.99.21" name="generator"></meta>
    <style type="text/css">
      body { text-align: justify } h5 { display: inline; padding-right: 1em }
      h6 { display: inline; padding-right: 1em } table { border-collapse:
      collapse } td { padding: 0.2em; vertical-align: baseline } dt { float:
      left; min-width: 1.75em; text-align: right; padding-right: 0.75em;
      font-weight: bold; } dd { margin-left: 2.75em; padding-bottom: 0.25em; }
      dd p { padding-top: 0em; } .subsup { display: inline; vertical-align:
      -0.2em } .subsup td { padding: 0px; text-align: left} .fraction {
      display: inline; vertical-align: -0.8em } .fraction td { padding: 0px;
      text-align: center } .wide { position: relative; margin-left: -0.4em }
      .accent { position: relative; margin-left: -0.4em; top: -0.1em }
      .title-block { width: 100%; text-align: center } .title-block p {
      margin: 0px } .compact-block p { margin-top: 0px; margin-bottom: 0px }
      .left-tab { text-align: left } .center-tab { text-align: center }
      .balloon-anchor { border-bottom: 1px dotted #000000; outline: none;
      cursor: help; position: relative; } .balloon-anchor [hidden] {
      margin-left: -999em; position: absolute; display: none; }
      .balloon-anchor: hover [hidden] { position: absolute; left: 1em; top:
      2em; z-index: 99; margin-left: 0; width: 500px; display: inline-block; }
      .balloon-body { } .ornament { border-width: 1px; border-style: solid;
      border-color: black; display: inline-block; padding: 0.2em; } .right-tab
      { float: right; position: relative; top: -1em; } .no-breaks {
      white-space: nowrap; } 
    </style>
    <link href="../resources/notes-base.css" type="text/css" rel="stylesheet"></link>
  </head>
  <body>
    <p>
      
    </p>
    <p>
      
    </p>
    <p>
      
    </p>
    <p>
      The TeXmacs editor offers the possibility of examining and modifying
      macro definitions through a &ldquo;shortcut&rdquo; tool, without having
      to know in which style file or package they are defined. 
    </p>
    <p>
      The tool is called &ldquo;Macro editor&rdquo;, and the modifications
      made via the Macro editor are saved in the preamble of the current
      document, while original definitions of macros are preserved in their
      respective files. The Macro editor can be used as well to write up a new
      macro starting from an existing macro.
    </p>
    <p>
      Let us examine two examples. 
    </p>
    <p>
      
    </p>
    <p>
      TeXmacs has a  macro which typesets its arguments (a reminder to self,
      let's say) with red font on a light red background, surrounded by
      brackets: .
    </p>
    <p>
      Let us see how to change the macro to have colored notes in different
      colors. The Macro editor is accessible from macro applications
      themselves, so we insert a  macro by typing <tt class="verbatim">\todo</tt>
      obtaining a red &ldquo;todo&rdquo; field: . With the cursor inside the
      (already typeset) macro field, a button that invokes the Macro editor
      becomes available in the TeXmacs tool ribbons; in Figure <a href="#fig:macro-editor-wrench">1</a>
      we highlight the &ldquo;wrench&rdquo; button.
    </p>
    <p>
      
    </p>
    <p>
      Clicking on the wrench button a menu appears, and we select &ldquo;Edit
      macro&rdquo; (Figure <a href="#fig:macro-edit-menu">2</a>); selecting &ldquo;Edit
      source&rdquo; would bring us to the location (package or style file)
      where the macro is defined.
    </p>
    <p>
      
    </p>
    <p>
      Clicking on &ldquo;Edit macro&rdquo; brings up the &ldquo;Edit
      macro&rdquo; window, the protagonist of this blog post (Figure <a href="#fig:macro-editor-window">3</a>).
      Let us ignore in this blog post the menu items  and , which would also
      allow a customization of the macro but do not have the general
      applicability of the macro editor.
    </p>
    <p>
      
    </p>
    <p>
      The first view is the &ldquo;text view&rdquo;, where the macro is
      represented in typeset form (as in the text mode of TeXmacs); in this
      case it results in a  note which displays the name of the variable in
      the macro definition (). We are interested in the source so we select
      &ldquo;Source&rdquo; from the drop-down menu at the bottom left (Figure
      <a href="#fig:macro-text-mode">4</a>).
    </p>
    <p>
      
    </p>
    <p>
      The macro now is represented in source mode and we can edit it (Figure
      <a href="#fig:macro-source-mode">5</a>).
    </p>
    <p>
      
    </p>
    <p>
      We would like to have green  notes. We identify tentatively the two
      variables <font color="#008000"><i>todo-color</i></font> and <font color="#008000"><i>todo-bg-color</i></font>
      as the color of the text and the color of the background&mdash;it looks
      reasonable, and if this does not work, we can check how the macro  is
      composed (in TeXmacs 1.99.18, which I am using to write this blog post,
      a bug prevents one to do this for the macro  through the macro
      editor&mdash;the attempt makes TeXmacs crash&mdash;so if you want to
      check that macro please use the  entry of the &ldquo;wrench&rdquo; menu
      and the file <tt class="verbatim">std-markup.ts</tt> will open at the position of
      the code for ; the discussion of the  example works despite this bug).
    </p>
    <p>
      We can check the values of the environment variables (see <a href="https://www.texmacs.org/tmweb/manual/webman-env.en.html">Standard
      environment variables</a> for a general discussion of the environment
      variables ) by typing them preceded by a backslash and pressing  (for
      this we can either switch out of the macro editor and use the usual
      TeXmacs editor or we can set the macro editor to Text mode): <font
      color="#008000"><i>todo-color</i></font> evaluates to  and <font color="#008000"><i>todo-bg-color</i></font>
      to . Let us then substitute dark green and pastel green for them.
    </p>
    <p>
      To type our new text in place of either <font color="#008000"><i>todo-color</i></font>
      or <font color="#008000"><i>todo-bg-color</i></font>, we first click
      <strong>four</strong> times onto it to select its name and the
      surrounding markup&mdash;clicking twice selects one of the words in the
      compound name of the variable (between hyphens), clicking three times
      selects the whole variable name without the  markup surrounding
      it&mdash;and then we type over it the text that we wish to: &ldquo;dark
      green&rdquo; (without the quotes) in place of <font color="#008000"><i>todo-color</i></font>
      and &ldquo;pastel green&rdquo; (likewise) in place of <font color="#008000"><i>todo-bg-color</i></font>.
    </p>
    <p>
      In Figure <a href="#fig:environment-variable-selected">6</a> we show the effect of clicking three or four
      times on the environment variable. When clicking three times (shown on
      the left side of the image), the  markup surrounding the variable name
      is not enclosed in the selection, which in this case does not reach the
      focus frame, as shown in the magnified view on the bottom; when clicking
      four times (as in the right side of the image), the selection reaches
      the edge of the focus frame and encloses the  markup.
    </p>
    <p>
      
    </p>
    <p>
      Clicking the  or the  button will save the edited macro in the document
      preamble.
    </p>
    <p>
      TeXmacs will save to the preamble the contents of the Macro editor
      window, so if one leaves the macro name as it is, the macro saved in the
      preamble is executed by TeXmacs in place of the original macro (while
      the original definition is not overwritten, the macro editor modifies
      only the current file). Changing in stead the name of the macro leaves
      the original definition in force&mdash;and one has a new macro with the
      new definition.
    </p>
    <p>
      Let us then in our example change the macro name to , by clicking inside
      the  field on top and typing, we will have then a new macro
      available&mdash;repeating ourselves, if we hadn't, the  macro would have
      pointed to the new definition we are saving in our preamble, and in this
      case all of the  fields would have become green, including the ones we
      had already written. You can see the edited macro in Figure <a href="#fig:todo-macro-edited-green">7</a>.
    </p>
    <p>
      
    </p>
    <p>
      Press  to close the Macro editor confirming the changes, and we can see
      the new macro  in our preamble: select  (in the &ldquo;Notes&rdquo;
      style: in other styles it is ). We look at it in Figure <a href="#fig:preamble">8</a>.
    </p>
    <p>
      
    </p>
    <p>
      We can now use the new macro:  and   (to do this, I started again from a
      note and applied again the Macro editor).
    </p>
    <p>
      For colors which do not have a name in TeXmacs, one can use HTML codes;
      if TeXmacs does not recognize a color name, it uses black.
    </p>
    <p>
      
    </p>
    <p>
      In math mode the macro  inserts a left brace that introduces a vertical
      list, represented with the help of a table.
    </p>
    <p>
      Here it is, inserted by typing <tt class="verbatim">\choice</tt>  inside a display
      math environment; we placed two elements inside it:
    </p>
    <p>
      
    </p>
    <p>
      Using the Macro editor, let's build a new macro that places the brace on
      the right.
    </p>
    <p>
      The first step is again placing the cursor in the macro input field (in
      the vector next to the brace in this case) and pressing the wrench key
      in the toolbar. The Macro editor window in this case shows the typeset
      macro in math mode (Figure <a href="#fig:choice_macro_math_mode">9</a>).
    </p>
    <p>
      
    </p>
    <p>
      The source mode representation of the macro is complex (Figure <a href="#fig:choice_macro_source_mode">10</a>),
      but maybe we do not need to know what is the  macro, nor what are <font
      color="#008000"><i>cell-swell</i></font> and <font color="#008000"><i>table-math-swell</i></font>;
      let's try.
    </p>
    <p>
      Let us notice the two paired delimiters <font color="blue">&lt;</font>left<font
      color="blue">|</font><font color="black">{</font><font color="blue">&gt;</font> and <font
      color="blue">&lt;</font>right<font color="blue">|</font><font color="black">.</font><font
      color="blue">&gt;</font>: we have to swap them. Of course, the left brace must
      become a right brace.
    </p>
    <p>
      As a second step, let us guess that the macro   and the variables <font
      color="#008000"><i>cell-swell</i></font> and <font color="#008000"><i>table-math-swell</i></font>
      determine the placement of the &ldquo;vector of choice&rdquo; with
      respect to the brace. We do not know whether  distinguishes right from
      left in such a way that the placement of the vector with respect to a
      closing brace would be awkward with the default settings of <font color="#008000"><i>cell-swell</i></font>
      and <font color="#008000"><i>table-math-swell</i></font>,
      but&mdash;again&mdash;let us try and see what happens!
    </p>
    <p>
      
    </p>
    <p>
      After swapping the position of the brace and the dot, the macro (which
      we named  looks like in Figure <a href="#fig:choice_macro_source_mode">10</a>. We press  to save the
      new macro in our preamble.
    </p>
    <p>
      
    </p>
    <p>
      We have to test it now. Let us type <tt class="verbatim">\choice-right</tt>, then 
      inside a display math environment, next to a  and place the same two
      elements into both constructs:
    </p>
    <p>
      
    </p>
    <p>
      The representation looks visually balanced, and we can keep the  macro
      that we have written (and that now is in our preamble).
    </p>
    <p>
      If we had not been happy, we would have had to figure out what the 
      macro does. Perhaps there too the first step could be looking at the
      macro in the Macro editor!
    </p>
    <p>
      
    </p>
    <p>
      If you want to modify a macro, place your cursor into it and open it
      with the Macro editor. If you see a likely candidate to change, change
      it and look at the result: you might immediately achieve what you want.
    </p>
    <p>
      If the macro looks too complex to be interpreted intuitively, or
      modifying it des not yield the result you expect, you can look for more
      detailed explanations in the manual; link to the manuals in various
      languages in pdf format are in the <a href="http://texmacs.org/tmweb/help/book.en.html">TeXmacs manuals</a> webpage
      and the web version is at <a href="https://www.texmacs.org/tmweb/manual/web-manual.en.html">web manual</a>. 
    </p>
    <p>
      You can also ask for help on
    </p>
    <ul>
      <li>
        <p>
          The <tt class="verbatim">texmacs-users</tt> mailing list (see instructions for
          subscribing at <a href="http://texmacs.org/tmweb/home/ml.en.html">Mailing lists for TeXmacs</a>)
        </p>
      </li>
      <li>
        <p>
          The <a href="http://forum.texmacs.cn/">TeXmacs forum</a>
        </p>
      </li>
    </ul>
    <p>
      
    </p>
  </body>
</html>